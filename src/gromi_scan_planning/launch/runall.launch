<?xml version="1.0"?>
<launch>

    <arg name="port_name" value="can0" />
    <arg name="simulated_robot" value="false" />
    <!--<arg name="model_xacro" default="$(find bunker_description)/urdf/bunker_v2.xacro" />-->
    <arg name="odom_topic_name" default="odom" />
    <arg name="is_bunker_mini" default="false" />
    <arg name="pub_tf" default="false" />
    <arg name="sim" default="false" />
    
    <group if="$(eval not sim)">
        <include file="$(find bunker_base)/launch/bunker_control_base.launch">
        <arg name="port_name" default="$(arg port_name)" />
        <arg name="simulated_robot" default="$(arg simulated_robot)" />
        <arg name="odom_topic_name" default="$(arg odom_topic_name)" />
        <arg name="pub_tf" default="$(arg pub_tf)" />
    </include>
    </group>


<!--    <include file="$(find bunker_description)/launch/description.launch">
        <arg name="model_xacro" default="$(arg model_xacro)" />
    </include>-->


    <group if="$(eval not sim)">
        <!--- Run VLP16 if sim == false -->
        <include file="$(find velodyne_pointcloud)/launch/VLP16_points.launch" />
        <!-- <include file="$(find vectornav)/launch/vn100_imu.launch" /> -->
    </group>

    <!--- Run Move Base -->
    <include file="$(find gromi_scan_planning)/launch/include/move_base.launch" >
    	<!--remap from="cmd_vel" to="/smoother_cmd_vel" /-->
    </include>	

    <!--- Run lego loam -->
    <!--include file="$(find gromi_scan_planning)/launch/include/lego_loam_run.launch" /-->
    <include file="$(find lego_loam)/launch/run.launch">
        <arg name="angle_threshold" value="3" />
        <arg name="sim" default="$(arg sim)" />
    </include>

 
    <node pkg="octomap_server_custom" type="octomap_server_node" name="octomap_server">
        <param name="resolution" value="0.2" />
        <param name="frame_id" type="string" value="map" />
        <param name="sensor_model/max_range" value="100.0" />
        <!--remap from="cloud_in" to="/laser_cloud_less_sharp" /-->
        <!--remap from="cloud_in" to="/vertical_cloud" /-->	
        <remap from="cloud_in" to="/segmented_cloud_pure" />
        <param name="ground" type="bool" value="true" />
        <remap from="projected_map" to="map" />
        <param name="latch" value="false" />
        <param name="pointcloud_min_z" value="-1.0"/>
     	<param name="pointcloud_max_z" value="1.0"/>
        <param name="groundcloud_min_z" value="-1.0"/>
     	<param name="groundcloud_max_z" value="0.0"/>
    </node>

    <!-- <include file="$(find explore_lite)/launch/explore.launch" /> -->
    <!-- <include file="$(find explore_lite)/launch/explore_costmap.launch" /> -->


    <node pkg="explore_lite" type="explore" respawn="false" name="explore" output="screen">
        <param name="robot_base_frame" value="base_link"/>
        <param name="costmap_topic" value="move_base/global_costmap/costmap"/>
        <param name="costmap_updates_topic" value="move_base/global_costmap/costmap_updates"/>
        <!-- <param name="costmap_topic" value="map"/>
        <param name="costmap_updates_topic" value="map_updates"/> -->
        <param name="visualize" value="true"/>
        <param name="planner_frequency" value="1.0"/>
        <param name="progress_timeout" value="10.0"/>
        <param name="potential_scale" value="1e-3"/>
        <param name="orientation_scale" value="0.0"/>
        <param name="gain_scale" value="1.0"/>
        <param name="transform_tolerance" value="0.3"/>
        <param name="min_frontier_size" value="0.5"/>
        <param name="maximum_distance" value="80.0"/>
        <param name="heading_angle" value="10.0"/>
    </node>

</launch>
